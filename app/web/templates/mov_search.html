{% extends "base.html" %}

{% block content %}

<h2 class="text-center">Поиск Фильм</h2>

<!-- Search Form -->
<div class="input-group mb-3">
    <input type="text" id="searchQuery" class="form-control" placeholder="Поиск по названию или описанию">
    <button class="btn btn-primary" onclick="searchMovies()">Search</button>
</div>

<div id="results" class="mt-3 row row-cols-1 row-cols-2 row-cols-md-3 row-cols-lg-4 g-4"></div>

<h2 class="text-center m-4">Последние фильмы</h2>

<!-- Movies Grid -->
<div id="moviesContainer" class="row row-cols-1 row-cols-2 row-cols-md-3 row-cols-lg-4 g-4"></div>

<!-- Pagination Controls -->
<div class="d-flex justify-content-center mt-4">
    <button id="prevBtn" class="btn btn-outline-primary me-2">Previous</button>
    <button id="nextBtn" class="btn btn-primary">Next</button>
</div>

<script>

    async function searchMovies() {
        let query = document.getElementById("searchQuery").value.trim();
        if (!query) {
            alert("Please enter a search term.");
            return;
        }

        let response = await fetch(`/api/movies/search?query=${encodeURIComponent(query)}&limit=100&offset=0`);
        let movies = await response.json();

        let resultsDiv = document.getElementById("results");
        resultsDiv.innerHTML = ""; // Clear previous results

        if (movies.length === 0) {
            resultsDiv.innerHTML = `<p class="text-center text-muted">No movies found.</p>`;
            return;
        }
        displayMovies(movies, 'results')
    }

    

</script>


<script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.12/dist/hls.min.js"></script>
<script src="{{ url_for('static', path='/movies.js') }}"></script>

{% endblock %}